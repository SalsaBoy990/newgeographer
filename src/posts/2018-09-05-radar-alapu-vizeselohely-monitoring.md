---
title: Radar-alapú vizesélőhely-monitoring
date: '2018-09-05'
excerpt: >-
  A tanulmányban a Felső-Kiskunsági tavak területén vizsgáltuk a felszíni
  vízborítás változásait 2014 szeptemberétől 2018 augusztusáig.A Hidrológiai
  Közlönybe szánt kézirat.
topic: 'Google Earth Engine, wetlands, radar, Sentinel-1'
---
### Kivonat
A Duna-Tisza közi szikes tavak, vizes élőhelyek rendkívül szélsőséges vízellátottságú területek, melyek érzékenyek az éghajlatváltozás indukálta szárazodással szemben, ugyanis ezek nagyrészt a lehulló csapadékból kapnak vízutánpótlást. A legtöbb passzív műholdas szenzor a felhőborítás és az alacsonyabb időfelbontás miatt nem alkalmas vizesélőhely-monitoringra. Viszont most már hozzáférünk a Sentinel-1 műholdak C-sávú szintetikus apertúra radarjának (C-SAR) felvételeihez, amelyek ingyenes, közepes térbeli felbontású (10 m), nagy időbeli felbontású (6 nap) és a felhőborítástól független adatokat szolgáltatnak. A tanulmányban a Felső-Kiskunsági tavak területén vizsgáltuk a felszíni vízborítás változásait 2014 szeptemberétől 2018 augusztusáig. Kidolgoztunk egy módszert a vízborítás detektálására, ami a radarképek automatikus osztályozásán alapszik. Az adatok feldolgozására a webböngészőn keresztül a Google Earth Engine felhőplatformot használtuk, amit a műholdképek és egyéb földi megfigyelési adatok feldolgozására hoztak létre. Az osztályozáshoz a wekaKmeans-nek nevezett eljárást használtuk. Verifikációképpen összevetettük az eredményül kapott vízborításokat a Landsat 8 és a Sentinel-2 műholdak adataiból számolt normalizált differenciált vízindex (NDWI, Normalized Difference Water Index) alapján meghatározott vízborításokkal. Az NDWI alapján történő lehatárolás egy küszöbértékes osztályozással történt. A küszöbértékeket vevő működési karakterisztika (angolul Receiver Operator Characteristics, ROC) eljárás segítségével kaptuk meg. Két teljesen különböző módszerrel és hullámhossz-tartományokon (radar/wekaKmeans, NDWI/ROC) közel azonos eredményeket kaptunk, magas Spearman-féle korreláció-értékekkel (ρ = 0,77-0,88).

### Kulcsszavak
*Sentinel-1 C-SAR, radar, Google Earth Engine, vizes élőhelyek, belvíz, Homokhátság, klaszterelemzés*

## BEVEZETÉS

Az éghajlatváltozás indukálta szárazodás a Duna-Tisza közén nagy hatással lehet az élővilág számára nagy értékkel bíró szikes tavainak, vizes élőhelyeinek szélsőséges vízellátottságára a térségben. A klímamodellek az aszályok növekvő gyakoriságát és erősségét prognosztizálják a Kárpát-medencében (***Mezősi*** és társai, 2016). A hazai folyószabályozások és lecsapolások után a megmaradt vizes élőhelyek nem vagy csak alig kapnak vízutánpótlást a folyókból, így a lehulló csapadékból táplálkozhatnak csupán. A csapadék éves eloszlásának változása, illetve különösképpen a tavaszi csapadékmennyiség csökkenése negatív hatással van a vízmérlegre (***Dawson*** és társai, 2003, ***Erwin*** 2009).

A tanulmány célja egy módszer kidolgozása a felszíni vízborítás térképezésére *a Sentinel-1 műholdak C-SAR* (C sávú szintetikus apertúra radarjának felvételei segítségével. Ezzel egy részletesebb betekintést kaphatunk a vizes élőhelyek vízborításában bekövetkező változásokba, mint azelőtt. Az így nyert vízborítási adatok segítségével képesek leszünk nyomon követni az időjárás által kiváltott, illetőleg az éghajlatváltozáshoz kötődő változásokat a vizes élőhelyeken, ami a vizes élőhelyek kezeléséhez és védelméhez fontos információkat szolgáltat. Ezelőtt sajnos nem voltak elérhetők ingyenes, nagy időbeli (6 nap) és közepes (10-30 m) térbeli felbontású radarfelvételek, csupán a passzív műholdak multispektrális felvételei álltak rendelkezésünkre. A passzív műholdak kevésbé alkalmasak monitoringra – főként a légköri zavaró hatások (aeroszol, felhőborítás, felhőárnyék) miatt –, így csupán hiányos idősorok nyerhetők a felvételekből. A radarok esetén azonban a mikrohullámok akadály nélkül áthatolnak még a vastag felhőzeten is.

A radarfelvételek feldolgozása a magas számításigény és a sok feldolgozási lépés miatt nagyon hosszadalmas lenne. A 2010-es évektől színre lépett a felhő alapú számítástechnika, amelyet az egyre növekvő mennyiségű digitális adat (angolul „big data”-nak nevezik) feldolgozásának a szüksége hívta életre. A felhő alapú szolgáltatások (cloud computing) közös jellemzője, hogy a szolgáltatásokat nem egy dedikált hardvereszközön üzemeltetik, hanem a szolgáltató eszközein elosztva, a szolgáltatás üzemeltetési részleteit a felhasználótól elrejtve. Ezeket a szolgáltatásokat a felhasználók a hálózaton keresztül érhetik el. Ez egy olyan szoftverszolgáltatási módszer, amelynél a szoftver és a kapcsolódó adatok központilag vannak tárolva (tipikusan egy internet felhőben, esetünkben a Google szerverein), ugyanakkor a felhasználói hozzáférések egy vékony kliensen keresztül zajlanak.

A *Google Earth Engine* egy ilyen felhő alapú platform, amit a műholdképek és egyéb földi megfigyelési adatok feldolgozására hoztak létre (***Gorelick*** és társai, 2017). Hozzáférést nyújt a Google képi adattáraihoz és biztosítja számítási teljesítményt és azokat a funkciókat, amik a képek feldolgozásához szükségesek. A JavaScript és a Python programozási nyelveken érhető el a Google Earth Engine API-ja (application programming interface, alkalmazásprogramozási felület – ezen keresztül férünk hozzá az internet felhőhöz szkriptek futtatásával). Mi a webböngészőből elérhető JavaScript API-t használjuk.

Visszatérve a radarokra, bár igaz, hogy a felhők nem befolyásolják, de nem állja meg a helyét teljesen az állítás, hogy teljes egészében időjárástól függetlenek lennének. A legsúlyosabb problémát a szél jelenti, ugyanis a szélsebesség és a felszín érdessége között kapcsolat áll fenn. Például az erős szélben a vízfelszínen hullámok alakulnak ki, amelyek növelik a vízfelszín érdességét, nagyobb visszaverődést eredményezve a szenzor felé (***Alsdorf*** és társai, 2007). Így a vízfelszín detektálásához ezt a problémát kezelni kell, ugyanis a szél a radarképen „elmoshat” bizonyos vízfelszíni elemeket (a vízfelszínre nagyon alacsony visszaverődés jellemző a mikrohullámú tartományban és ezt növeli meg a szél).

Más felszínek (pl. aszfalt, beton) is hasonló érdességgel bírnak, mint a vízfelszínek, ezért ezek is összetéveszthetők a nagyon hasonló vagy teljesen azonos visszaszórási értékek miatt. Bár e felületek kizárása (kimaszkolása) könnyedén megoldható.

A C-sávú radarok (5 GHz frekvencia vagy 5 cm hullámhossz körül) a lágyszárú növényzettel borított vizes élőhelyeknél, míg az alacsonyabb frekvenciák (P-sáv, L-sáv) az erdőborítás alatti elárasztás detektálására használhatók (Hess 1990). Ennek az oka, hogy – az L és a P sávval ellentétben – a C-sávban a radar által kibocsátott mikrohullámú sugarak nem hatolnak át a lombkoronaszinten, hanem a lombozatról verődnek vissza, mivel a hullámhossz összemérhető a levelek méretével (***Engman*** 1996, ***Lang és Kasischke*** 2008). 

A radarhullámok visszaverődése a felszín fizikai tulajdonságaitól függ. A felszíni vízborítás elkülönítésében a felszín érdessége játszik szerepet. Minél érdesebb a felszín, annál nagyobb a visszaszóródás a radarantenna felé, és annál fényesebb objektum látszódik majd a felvételen. A vízfelszín a többi felszíntípushoz képest nagyon alacsony érdességgel bír, más szóval nagyon sima. Az ilyen sima felületekről kevés energia szóródik vissza, a radarhullámok a szenzortól elfele irányba verődnek tovább, így nagyon sötét objektumokként tűnnek fel a képeken. A lényeg, hogy erős kontraszttal különül el a vízborítás. A vízborítást a tapasztalatok szerint -17- -18 dB (decibel) vagy kisebb visszaszóródási értékek jellemzik.

A vízborítás érzékelésére az azonos polarizáltságú (HH, VV) adatok alkalmasabbak. Legalkalmasabb a HH-polarizáció, de a VV szintén megfelelő választás (***Kasischke*** et al. 1997, ***Bourgeau-Chavez*** és társai, 2010). Bár azt is érdemes itt hozzátenni, hogy a kereszt-polarizált sávok is fontos információkat hordoznak, különösen, ha a felszínborítást akarjuk térképezni (***Baghdadi*** 2010). A különböző felszíntípusokat más visszaverődés jellemez a VV és a VH polarizáltságú sávokban.

A Homokhátság szárazodásának egy lehetséges hatása a mintaterületre
A Homokhátságban a talajvízszintek 1956-60-as kiinduló állapothoz képest az 1990-es évek közepéig átlagosan 2,5-3 métert süllyedtek (***VITUKI*** 2006). A vízszintsüllyedés okainak keresésére és modellezésére számtalan tudományos kutatás folyt és folyik jelenleg is hazánkban.

***Szilágyi és Vörösmarty*** (1993) szerint az 1960. évi állapotból kiindulva az 1961-1987 között tapasztalható talajvízszint-süllyedést *70%-ban a rétegvíz-kitermelés*, 15%-ban a kedvezőtlen időjárás és 15%-ban az erdőterületek növekedése okozta. ***Pálfai*** (1994) szerint: *időjárás (csapadék és párolgás) – 50%*; rétegvíz-kitermelés – 25%; talajvíz-kitermelés – 6%; területhasználatban bekövetkezett változások – 10%; vízrendezésben bekövetkezett változások – 7%; és egyéb tényezők (pl. szénhidrogén-bányászat, stb.) – 2%. ***Kohán*** (2014) szerint az 1970-es évek végéig elsősorban a klíma határozta meg a talajvízszintet, de 1980 után már a nem időjárási okok is jelentősen közrejátszottak a süllyedésben: a természetes tényezőkön felül az erdőtelepítések 53 cm-rel, a vízkitermelés pedig 70 cm-rel járulhatott hozzá az átlagos talajvízszint csökkenéséhez 1981-2010 között.

Duna–Tisza közén tapasztalható talajvízszint-süllyedés hátterében *fő tényezőként a csapadékhiány áll* (***Völgyesi*** 2006, ***Szanyi és Kovács B.*** 2009, ***Rakonczai*** 2013). ***Völgyesi*** (2006) a MODFLOW áramlásmodellező szoftver segítségével modellezte a Homokhátság vízháztartását és arra az eredményre jutott, hogy a talajvízszintek csökkenésében *a legerősebb tényező az időjárás. A magas térszínű területeken körülbelül 80 %-os súlyú*. Körülbelül 13 %-os súllyal befolyásolják a magas térszínű területek talajvízszintjét az erdők. 5 % alatti szerepük van a belvízcsatornáknak. A víztermelés utolsó 10 évben történt változása pedig 2 %-nál is kisebb hatású.

A mintaterületünk, *a Felső-Kiskunsági tavak* a Duna negyedkori árterületén helyezkednek el, amit egyrészt *a Hátság területén beszivárgó vizek feláramlási területeként*, másrészt pedig a Kárpát-medence regionális áramlási rendszerébe illesztve a mélységi vizek feláramlási zónái egyikének ismerünk (***Erdélyi*** 1975, ***Tóth és Almási*** 2001, ***Mádlné*** és társai 2005, ***Szalai*** és társai 2010). Tehát a magasabb hátsági területeken a csapadékból beszivárgó víz a gravitációnak engedelmeskedve a nyugati perem felé, a tavak irányába áramlik a felszín alatt, hozzájárulva ezzel a tavak vízpótlásához. A kérdés csak az, hogy ennek a hozzáfolyásnak mekkora hatása lehet a felszíni vízborításokra? A Felső-Kiskunsági tavak területén lehulló helyi csapadéké és párolgásé, vagy a hozzáfolyásé a meghatározó szerep? Ha feltételezzük, hogy tovább csökken a Homokhátság vízutánpótlódása, akkor a fentiek szerint a tavak vízborításának is csökkennie kell. Bár az is elképzelhető, hogy nincs valós kapcsolat a kettő között.

## ADAT ÉS MÓDSZER

### A Sentinel-1 C-sávú szintetikus apertúrájú radar jellemzői röviden

Két poláris pályán keringő műholdon (a 2014 áprilisa óta üzemelő Sentinel 1A, és a 2016 áprilisa óta operáló Sentinel 1B) található oldalra pásztázó C-SAR berendezés szolgáltatja az adatokat. A radar mind horizontálisan (H), mind pedig vertikálisan (V) polarizált mikrohullámokat tud kibocsátani, illetve fogadni. A fő felvételezési mód az ún. Interferometrikus Szélessáv mód (Interferometric Wide Swath), ami egy 250 km-es sávban történő felvételezést jelent. Geometriai felbontás: 20*22 méter, amit 10 méterre mintáznak át. A szárazföld felett VH és VV polarizáltságú sávokban készül a műholdkép. A vetületi rendszer WGS84. Az időfelbontás 6 nap (Torres és társai, 2012). A Level-1 Ground Range Detected (GRD) adatokat használom.

### Az adatok feldolgozása a Google Earth Engine-nel

Az Earth Engine adatbázisa már előfeldolgozott radarképeket tartalmaz. Az alábbi előfeldolgozási lépéseket végezték el a Sentinel-1 Toolbox szoftver implementációja alapján (***Google Earth Engine Team*** 2015):

1. Pályaadatokkal való korrekció;
2. Háttérzaj eltávolítása (a kép szélein látható sötét sávok érvénytelen adatokkal);
3. Radiometrikus kalibráció: visszaszóródás intenzitásértékeinek számítása a szenzoros kalibrációs paraméterek alapján;
4. Domborzati korrekció: az adatok felszíni tartományba konvertálása az SRTM DEM alapján;
5. A mértékegység nélküli visszszóródási együttható (σ°) dB-be konvertálása (`10*log10*σ°`);
6. Az értékek leszorítása az 1. és a 99. percentilis értékére, 16 bitbe kvantálás.

A további feldolgozási lépéseket nekünk kellett végezni.

Először is normalizálni kellett a visszaszóródási értékeket a mikrohullámok beesési szögével, az ún. *koszinusz korrekció* segítségével (Ulaby és társai 1982). Ez nélkülözhetetlen lépés, ugyanis a kicsi beesési szögek nagyobb visszaverődést, míg a nagyobb szögek kisebb visszaverődést eredményeznek. A beesési szögekből származó eltérések nem csak egy képen belül jelentkeznek, hanem különböző szenzorok esetén, valamint eltérő felvételezési geometriák, más műholdpályák esetén is (emelkedő és süllyedő pályák). Ez nagy beesési szög varianciát okoz a különböző időben készült felvételekben. A normalizáció nélkül ezek nem hasonlíthatók össze (***Weiß*** 2018).

Másodszor: A szeles időben készült radarfelvételeket ki kellett zárnunk a vizsgálatból, hogy kiküszöböljük a szél általi felszíni érdesség hatásokat (***Elyouncha*** és társai, 2015). Az 1 m/s feletti szélsebességű területeket kizártuk. Erre a célra rendelkezésre álltak a `CFSV2: NCEP Climate Forecast System Version 2, 6-Hourly Products` 20 km felbontású klimatológiai adatok (***Saha*** és társai, 2011), melyekből kinyerhetjük a szélsebességet (a `v` és az `u` komponensek felhasználásával). A szélsebesség-adatok a felszín felett 10 méterre vonatkoznak.

A következő lépés volt a tüskeszűrés (angolul speckle filtering), amire az általánosan használt Finomított Lee szűrőt (Lee 1980, 1981) alkalmaztuk, amihez rendelkezésre állt egy kész szkript a Google Earth Engine-ben (***Yommy*** és társai, 2015). Ezzel a radarképeken megfigyelhető, a sugárforrás által kibocsátott és a visszaverődő radarhullámok között fellépő interferencia okozta szemcsés zajt jelentősen lecsökkenthetjük.

Az utolsó lépés a vizsgált időszakra vonatkozó átlagképek számítása volt. Havi léptékben vizsgálódunk, de tetszés szerint lehet más időszakra is átlagolni. Ez a lépés tovább javítja a kép minőségét. Külön készítettünk átlagképet az emelkedő pályán (tehát amikor a műhold az Egyenlítő felől halad a sarkok felé) és a süllyedő pályán (északról délre) készült felvételekből.

A korrigált adatok automatikus osztályozása és a statisztikák számítása
Az úgynevezett `wekaKMeans` klaszterezési algoritmust használtam, ami egy továbbfejlesztett kmeans típusú kemény osztályozás (***Arthur és Vassilvitskii*** 2007). Az osztályközepektől való eltéréseken alapul, csakúgy, mint az `ISODATA` algoritmus. A `wekaKMeans` a kezdeti osztályközepeket véletlenszerű mintákból számítja. Távolság függvénynek az euklideszi távolságot használtunk. A kimenő klaszterek számát 15-re állítottuk és a VV és a VH sávot is felhasználtam az osztályozásnál.

A tapasztalatok szerint a `-17- -18` dB körüli vagy alacsonyabb klaszterközéppel rendelkező osztályok vízborítást jeleznek. Az eredményeket a felhasználónak kell értelmeznie. Ez az egyetlen lépés, amely nem automatizálható.
Miután meghatározásra kerültek a vízborításos osztályok, újraosztályoztuk az osztályozott képet az alábbiak szerint:

* vízborítás: 1
* nincs vízborítás: 0.

Az utolsó lépésként pedig az újraosztályozott kép alapján kiszámítottuk a vízzel borított terület nagyságát.

A statisztikai elemzéseket (lineáris regresszió, korreláció) és a diagramokat az R for Windows szoftver segítségével készítettük el. A statisztikai kapcsolatok kiértékelésekor Pearson-féle (`R`-érték) és Spearman-féle (`ρ`-érték) korrelációkat számoltunk, valamint szignifikancia tesztet is végeztünk.

A verifikációhoz a Landsat 8 Operational Land Imager (OLI) és a Sentinel-2 MultiSpectral Instrument (MSI) légkör teteji reflektancia értékekből számolt vízindexet használtunk. A Landsat adatok geometriai felbontása 30, míg a Sentinel-2 adatoké 20 méter. A normalizált differenciált vízindexek (NDWI, Normalized Difference Water Index) gyakran használatosak a felszíni vízborítás detektálására (***McFeeters*** 1996, ***Xu*** 2006, ***Li*** és társai, 2013, ***van Leeuwen*** és társai, 2017). ***Xu*** (2006) vízindexét használtuk, ugyanis ezzel lehet a legpontosabban meghatározni a vízborítást: `NDWI = (G − MIR) / (G + MIR)`, ahol `G` a látható zöld hullámhossz-tartomány műholdkép sávja, `MIR` (middle infrared): ez a középső infravörös sáv (központi hullámhossz: `2,1` μm). Sajnos bővebb magyarázatot a tartalmi korlátok miatt nem adhatunk, de a megadott hivatkozásokban minden információ elérhető.

A vízindex értékeket az úgynevezett „vevő működési karakterisztika” (angolul Receiver Operator Characteristics, ROC) módszer segítségével osztályoztam (***Gulácsi*** 2017). Ez egy küszöbértékes eljárás, melynek lényege a következő: különböző küszöbértékek esetén megvizsgáljuk, hogy egy bináris osztályozónak mekkora az igaz pozitív aránya (tehát amikor helyesen vízborítást jelez az osztályozó) és a hamis pozitív aránya (téves vízborítás detektálás). Mi azt az osztályozót (és a hozzá tartozó küszöbértéket) keressük, aminél az igaz pozitív arány a lehető legmagasabb, míg a hamis pozitív arány a legkisebb. Ehhez referenciaként felhasználtam két időpontban egy-egy elérhető Pléiades és WorldView-3 nagy felbontású műholdképet (a Google Earth adatbázisából). A Landsat 8 esetén a `0,625` vagy nagyobb, míg a Sentinel-2 esetén `0,57` vagy nagyobb indexértékek jeleznek vízborítást. Ez alapján osztályoztuk a képeket és megkaptuk a vízborításokat.


